<div class="left-monster-container"></div>
    <div class="monster-image-container">
        <img class="monster-image primary-outline" src="{{this.system.img}}" data-action="avatarFilePicker" data-path="system.img" />
        <i class="show-icon fa-solid fa-image fa-fw primary-hover-container" data-action="imagePopout"></i>
    </div>


        <div class="data-section full primary-container active">
            <div class="data-header primary-container">
                    <div class="data-header-label">
                        <i class="fa-solid fa-users"></i>
                        <div class="flex-value">{{localize "Participants"}}</div>
                    </div>
                </div>
                <div class="data-body primary-border-container pf2e-bestiary-standard-gap">
                    {{#if this.editMode}}
                        <button class="tertiary-container" data-action="addParticipant" data-path="system.chaseData.participants"><i class="fa-solid fa-plus"></i> Add</button>
                        {{#each this.system.getParticipants}}
                            {{#if this.player}}
                                <div class="participant-container secondary-container">
                                    <div class="participant-inner-container editing secondary-border-container">
                                        <div class="title-section">
                                            <img src="{{this.img}}" />
                                            <div>{{this.name}}</div>
                                        </div>
                                    </div>
                                </div>
                            {{else}}
                                <div class="participant-edit-container">
                                    <img class="primary-hover-container" src="{{this.img}}" data-action="avatarFilePicker" data-path="{{concat "system.chaseData.participants." this.id ".img"}}" />
                                    <input class="secondary-container" type="text" name="{{concat "system.chaseData.participants." this.id ".name" }}" value="{{this.name}}" />
                                    <i class="remove-icon primary-hover-container fa-solid fa-circle-xmark" data-action="removeParticipant" data-path="system.chaseData.participants" data-key="{{this.id}}"></i>
                                </div>
                            {{/if}}
                        {{/each}}
                    {{else}}
                        <h4 class="participants-title">
                            <span>
                                {{localize "Players"}}
                                <div class="participants-tools">
                                    <i class="fa-solid fa-caret-up primary-hover-container" data-action="increasePartyParticipantObstacle"></i>
                                    <i class="fa-solid fa-caret-down primary-hover-container" data-action="decreasePartyParticipantObstacle"></i>
                                </div>
                            </span>
                        </h4>
                        <div class="participants-container primary-border-container">
                            {{#each this.system.playerParticipants}}
                                <div class="participant-container secondary-container">
                                    <div class="participant-inner-container secondary-border-container">
                                        <div class="title-section">
                                            <img src="{{this.img}}" />
                                            <div>{{this.name}}</div>
                                        </div>
                                    </div>
                                    <div class="participant-obstacle-container">
                                        <span>{{localize "Obstacle"}}:&nbsp;{{add this.currentObstacle 1}}</span>
                                        <i class="fa-solid fa-plus primary-hover-container" data-action="increaseParticipantObstacle" data-path="{{concat "system.chaseData.participants." this.id}}" id="{{this.id}}"></i>
                                        <i class="fa-solid fa-minus primary-hover-container {{#if (eq this.currentObstacle 0)}}disabled{{/if}}" data-action="decreaseParticipantObstacle" data-path="{{concat "system.chaseData.participants." this.id}}" id="{{this.id}}"></i>
                                    </div>
                                </div>
                            {{/each}}
                        </div>
                        {{#each this.system.nonPlayerParticipants}}
                            <div class="participant-container secondary-container">
                                <div class="participant-inner-container secondary-border-container">
                                    <div class="title-section">
                                        <img src="{{this.img}}" />
                                        <div>{{this.name}}</div>
                                    </div>
                                    {{#if ../user.isGM}}
                                        <i class="{{#if this.hidden}}fa-solid fa-eye-slash{{else}}fa-solid fa-eye{{/if}} primary-hover-container" data-action="toggleParticipantHidden" data-path="{{concat "system.chaseData.participants." this.id ".hidden"}}"></i>
                                    {{/if}}
                                </div>
                                <div class="participant-obstacle-container">
                                    <span>{{localize "Obstacle"}}:&nbsp;{{add this.currentObstacle 1}}</span>
                                    <i class="fa-solid fa-plus primary-hover-container" data-action="increaseParticipantObstacle" data-path="{{concat "system.chaseData.participants." this.id}}" id="{{this.id}}"></i>
                                    <i class="fa-solid fa-minus primary-hover-container {{#if (eq this.currentObstacle 0)}}disabled{{/if}}" data-action="decreaseParticipantObstacle" data-path="{{concat "system.chaseData.participants." this.id}}" id="{{this.id}}"></i>
                                </div>
                            </div>
                        {{/each}}
                    {{/if}}
                </div>
        </div>
</div>

<div class="right-monster-container">
    <div class="flexcol">
        <div class="monster-name-container">
            <div class="monster-name primary-container {{PF2EBTToggleContainer this.user this.system.name}}" style="{{PF2EBTToggleContainerOverride this.contrastRevealedState this.system.name}}" data-action="toggleRevealed" data-path="system.name" data-name="{{localize "PF2EBestiary.Miscellaneous.Name"}}">
                {{#if (or this.user.isGM this.system.name.revealed)}}
                    {{PF2EBTTertiary this.system.name.custom this.system.name.value}}
                {{else}}
                    {{localize "PF2EBestiary.Bestiary.Miscellaneous.UnknownEvent"}}
                {{/if}}
            </div>
            <div class="bestiary-toolbar-container">
                <div class="toggle-switch-container">
                    {{#if this.user.isGM}}
                        <div class="toggle-switch">
                            <i class="fa-solid fa-screwdriver-wrench"></i>
                            <input type="checkbox" name="npcData.editMode" {{checked this.editMode}} title="{{localize "PF2EBestiary.Bestiary.NPC.EditModeText"}}" />
                        </div>
                    {{/if}}
                    <div class="toggleSwitch">
                        <i class="fa-solid fa-passport primary-hover-container" data-action="copyEntityLink" title="{{localize "PF2EBestiary.Bestiary.Info.BestiaryEntryLinkTip"}}"></i>
                    </div>
                </div>

                <nav class="bestiary-tabs tabs">
                    {{#each this.tabs as |tab|}}
                        <a 
                            class="bestiary-tab secondary-container primary-tab {{tab.cssClass}}" 
                            data-action="tab" 
                            data-group="{{tab.group}}" 
                            data-tab="{{tab.id}}"
                        >
                            <i class="{{tab.icon}}"></i>
                            <label>{{tab.label}}</label>
                        </a>
                    {{/each}}
                </nav>
            </div>
        </div>
    </div>

    <div class="tab {{this.tabs.event.cssClass}}" data-group="event" data-tab="event">
        <div class="right-monster-container-data">
            <div class="data-section full primary-container active">
                <div class="data-header main primary-container">
                    <div class="data-header-label">
                        <i class="fa-solid fa-chevron-left"></i>
                            <div class="flex-value">{{localize "Fiery Plains (2/6)"}}</div>
                        <i class="fa-solid fa-chevron-right"></i>
                    </div>
                   {{#if this.editMode}}<i class="header-add-icon fa-solid fa-plus primary-hover-container" data-action="addChaseObstacle"></i>{{/if}}
                </div>
                <div class="data-body primary-border-container pf2e-bestiary-standard-gap">
                    {{#if this.editMode}}
                        {{#each this.system.chaseData.obstacles}}
                            <div class="obstacle-edit-row">
                                <img class="primary-hover-container" src="{{this.img}}" data-action="avatarFilePicker" data-path="{{concat "system.chaseData.obstacles." @key ".img"}}" />
                                <input type="text" name="{{concat "system.chaseData.obstacles." @key ".name"}}" value="{{this.name}}" />
                            </div>
                            <input type="text" data-dtype="Number" name="{{concat "system.chaseData.obstacles." @key ".chasePoints.goal"}}" value="{{this.chasePoints.goal}}" />
                            <prose-mirror class="primary-editor" name="{{concat "system.chaseData.obstacles." @key ".overcome"}}" value="{{this.overcome}}" toggled="true">
                                {{{this.enrichedOvercome}}}
                            </prose-mirror>
                        {{/each}}
                    {{else}}
                        {{#each this.system.chaseData.obstacles}}
                            <div class="chase-obstacle-container">
                                <img src="{{this.img}}" />
                                <div>{{{this.enrichedOvercome}}}</div>
                            </div>
                        {{/each}}
                    {{/if}}
                </div>       
            </div>
        </div>
    </div>

    <div class="tab {{this.tabs.notes.cssClass}}" data-group="event" data-tab="notes">
        <div class="bestiary-notes-page">
            <fieldset class="bestiary-notes-legend player-notes main-border-container primary-container-faded">
                <legend>
                    <div class="data-container primary-container">{{localize "PF2EBestiary.Bestiary.PlayerNotes.Title"}}</div>
                </legend>
                <prose-mirror class="primary-editor" name="system.notes.player.value" data-document-u-u-i-d="{{this.uuid}}" value="{{this.system.notes.player.value}}" collaborate="true" toggled="true">
                    {{{this.system.notes.player.enriched}}}
                </prose-mirror>
            </fieldset>
        </div>
    </div> 
</div>